@import utils.navigation.NavigationComponent
@import security.LoginState.User
@import controllers.routes.PersonController
@import controllers.FlashKey.DeletedPerson
@import controllers.FlashKey.DeletedToken
@import controllers.FlashKey.PersonNotFound
@import controllers.FlashKey.PersonAdded
@import controllers.FlashKey.PersonUpdated

@(
    persons: Seq[Person]
)(
    implicit navigation: NavigationComponent,
    user: User,
    request: RequestHeader,
    flash: Flash
)

@keys = @{ Seq(PersonAdded, PersonUpdated).map(flash.get(_).getOrElse("").toString) }

@main(userOpt = Some(user), title = "List persons") {
    <p>This table lists all Persons.</p>
    @for(pid <- flash.get(PersonAdded)) {
        <div class="alert alert-success" role="alert">Inserted new Person with ID @pid</div>
    }
    @for(pid <- flash.get(PersonUpdated)) {
        <div class="alert alert-success" role="alert">Updated Person with ID @pid</div>
    }
    @for(_ <- flash.get(PersonNotFound)) {
        <div class="alert alert-danger" role="alert">No Person found.</div>
    }
    @for(pid <- flash.get(DeletedPerson)) {
        <div class="alert alert-success" role="alert">Person ID #@pid deleted.</div>
    }
    @for(tid <- flash.get(DeletedToken)) {
        <div class="alert alert-success" role="alert">Token ID #@tid deleted.</div>
    }
    <div class="table-responsive">
        <table class="table table-striped table-sm">
            <thead>
            <tr>
                <th>Database ID</th>
                <th>Member ID</th>
                <th>Name</th>
                <th>E-Mail</th>
                <th>Active</th>
                <th>Modify</th>
                <th>Qualifications</th>
            </tr>
            </thead>
            <tbody>@for(person <- persons) {
                @if(keys.contains(person.id.get.toString)) {<tr class="table-success">} else {<tr>}
                    <td>@person.id</td>
                    <td>@person.memberId</td>
                    <td>@person.name</td>
                    <td>@person.email</td>
                    <td><input type="checkbox" disabled @if(person.isActive) {checked="checked"}></td>
                    <td><a href="@PersonController.modifyPerson(person.id.get)"><span data-feather="edit"><!-- edit --></span></a></td>
                    <td><a href="@PersonController.addQualification(person.id.get)"><span data-feather="layers"><!-- layers --></span></a></td>
                </tr>
            }</tbody>
        </table>
    </div>
}
